var app=app||{};app.SimpleRevisionView=Backbone.View.extend({el:"#treatment-simple-revision",events:{"click #instruction-read":"renderEditor","click #help":"renderInstructionModal","click #editor-button":"analyzeText"},initialize:function(){var e=this;this.prePageDurationStart=null,this.postPageDurationStart=null,this.userModel=new app.UserSpecificModel,this.textModel=new app.TextModelComplete,this.analyzer=new app.TextAnalyzerModel,this.userModel.fetch({success:function(t,n){e.renderInstruction()},error:function(e,t){console.log(t)}})},renderInstruction:function(){this.$el.html(Handlebars.templates.instruction({instruction:this.userModel.get("instruction")}))},renderEditor:function(){this.prePageDurationStart=new Date,this.$el.html(Handlebars.templates.editor());var e=new MediumEditor("#editor-textinput",{toolbar:!1,placeholder:!1});$("#editor-textinput").html("<p>Schreibe hier ...</p>");var t=document.querySelector("#editor-textinput").firstChild;e.selectElement(t),this.$el.append('<i id="help" class="material-icons">help</i>'),this.$el.append(Handlebars.templates["modal-help"]({instruction:this.userModel.get("instruction")}))},renderInstructionModal:function(){$("#modal-help").openModal()},analyzeText:function(){var e=this;app.regExText("#editor-textinput");var t=app.getParagraphs(this.$el.find("#editor-textinput")),n=app.getPlainText(this.$el.find("#editor-textinput"));if(t.length<1e3)Materialize.toast("Ihr Text ist leider zu kurz.",4e3);else{var i=(new Date-this.prePageDurationStart)/1e3;this.textModel.set({pre_page_duration:i,pre_text:n}),this.$el.find("#editor-button-div").html(Handlebars.templates["loading-ring"]()),this.analyzer.set({text:t}),this.analyzer.save(null,{success:function(t){e.saveText()},error:function(e,t){console.log(t.responseText)}})}},saveText:function(){var e=(new Date-this.postPageDurationStart)/1e3;this.$el.find("#editor-button-div").html(Handlebars.templates["loading-ring"]());var t=(app.getParagraphs(this.$el.find("#editor-textinput")),app.getPlainText(this.$el.find("#editor-textinput")));this.textModel.set({post_text:t,post_page_duration:e,pre_num_sentences:this.analyzer.get("numSentences"),pre_num_clusters:this.analyzer.get("numClusters"),pre_num_coherent_sentences:this.analyzer.get("cohSentences"),pre_num_non_coherent_sentences:this.analyzer.get("cohNotSentences"),pre_num_concepts:this.analyzer.get("numConcepts"),post_num_sentences:this.analyzer.get("numSentences"),post_num_clusters:this.analyzer.get("numClusters"),post_num_coherent_sentences:this.analyzer.get("cohSentences"),post_num_non_coherent_sentences:this.analyzer.get("cohNotSentences"),post_num_concepts:this.analyzer.get("numConcepts")}),this.textModel.save(null,{success:function(e){location.reload()},error:function(e,t){Materialize.toast("Dein Text konnte nicht gespeichert werden.",4e3)}})}}),new app.SimpleRevisionView;
//# sourceMappingURL=simple-text.js.map
